"use strict";(self.webpackChunksudeeparyan_knowledgebase=self.webpackChunksudeeparyan_knowledgebase||[]).push([[8462],{76077:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>o,contentTitle:()=>i,default:()=>c,frontMatter:()=>s,metadata:()=>l,toc:()=>d});var r=a(74848),t=a(28453);const s={},i=void 0,l={id:"RAG360/Retrieval/Structured/PandasSQL",title:"PandasSQL",description:"What is Pandas SQL?",source:"@site/docs/RAG360/Retrieval/Structured/PandasSQL.md",sourceDirName:"RAG360/Retrieval/Structured",slug:"/RAG360/Retrieval/Structured/PandasSQL",permalink:"/docs/RAG360/Retrieval/Structured/PandasSQL",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"ragSidebar",previous:{title:"Overview",permalink:"/docs/RAG360/Retrieval/Structured/Overview"},next:{title:"PandasLLM",permalink:"/docs/RAG360/Retrieval/Structured/PandasLLM"}},o={},d=[{value:"What is Pandas SQL?",id:"what-is-pandas-sql",level:3},{value:"<strong>Explanation</strong>",id:"explanation",level:4},{value:"Why We Need Pandas SQL",id:"why-we-need-pandas-sql",level:3},{value:"<strong>Problem Statement</strong>",id:"problem-statement",level:4},{value:"<strong>Use Cases</strong>",id:"use-cases",level:4},{value:"<strong>Benefits</strong>",id:"benefits",level:4},{value:"Advantages and Disadvantages",id:"advantages-and-disadvantages",level:3},{value:"<strong>Advantages</strong>",id:"advantages",level:4},{value:"<strong>Disadvantages</strong>",id:"disadvantages",level:4},{value:"Example",id:"example",level:3},{value:"<strong>Output</strong>",id:"output",level:4}];function h(e){const n={code:"code",h3:"h3",h4:"h4",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h3,{id:"what-is-pandas-sql",children:"What is Pandas SQL?"}),"\n",(0,r.jsx)(n.h4,{id:"explanation",children:(0,r.jsx)(n.strong,{children:"Explanation"})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Pandas SQL involves the utilization of SQL syntax or SQL-like queries within\r\nthe context of Python's Pandas library to manipulate structured data directly\r\nfrom DataFrames."}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Pandas does not inherently support SQL; however, there are tools and\r\nlibraries such as ",(0,r.jsx)(n.code,{children:"pandasql"})," or integrations with databases through\r\nSQLAlchemy that allow SQL-style querying on DataFrame objects."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"This technique enables users who are familiar with SQL to apply similar query\r\nlogic to manipulate, filter, or transform data in DataFrames without\r\ntransitioning away from the Python ecosystem."}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Employing Pandas SQL facilitates the blending of structured data handling\r\nwith Python's analytical capabilities, thus enhancing data retrieval\r\nprocesses from structured sources like databases or spreadsheets."}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"It fits into the broader picture of structured retrieval by providing a\r\nflexible and powerful tool for data analysis within the Python environment,\r\nparticularly beneficial where complex data transformations and aggregations\r\nare required."}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"why-we-need-pandas-sql",children:"Why We Need Pandas SQL"}),"\n",(0,r.jsx)(n.h4,{id:"problem-statement",children:(0,r.jsx)(n.strong,{children:"Problem Statement"})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Handling large datasets often requires sophisticated data filtering,\r\ntransformation, and analysis that go beyond basic DataFrame operations."}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Traditional Python operations on Pandas DataFrames, although powerful, might\r\nnot always be intuitive for those accustomed to SQL."}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Moreover, translating complex logic into Pandas operations can sometimes\r\nbecome verbose and hard to maintain."}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"use-cases",children:(0,r.jsx)(n.strong,{children:"Use Cases"})}),"\n",(0,r.jsxs)("table",{class:"table-size-for-cloud-services",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{children:"Factors"}),(0,r.jsx)("th",{children:"Reason"})]})}),(0,r.jsxs)("tbody",{children:[(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:(0,r.jsx)("span",{class:"custom-header",children:"Data Analysis"})}),(0,r.jsx)("td",{children:"Quickly running ad-hoc queries on large DataFrames."})]}),(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:(0,r.jsx)("span",{class:"custom-header",children:"Data Transformation"})}),(0,r.jsx)("td",{children:"Implementing complex data transformations easily using SQL syntax."})]}),(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:(0,r.jsx)("span",{class:"custom-header",children:"Integration Testing"})}),(0,r.jsx)("td",{children:"Simplifying the process of testing by using SQL queries directly on DataFrames to replicate database states and operations during testing phases."})]})]})]}),"\n",(0,r.jsx)(n.h4,{id:"benefits",children:(0,r.jsx)(n.strong,{children:"Benefits"})}),"\n",(0,r.jsxs)("table",{class:"table-size-for-cloud-services",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{children:"Factors"}),(0,r.jsx)("th",{children:"Reason"})]})}),(0,r.jsxs)("tbody",{children:[(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:(0,r.jsx)("span",{class:"custom-header",children:"Leveraging SQL Expertise"})}),(0,r.jsx)("td",{children:"Allows users proficient in SQL to directly apply their knowledge."})]}),(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:(0,r.jsx)("span",{class:"custom-header",children:"Enhanced Readability and Maintainability"})}),(0,r.jsx)("td",{children:"SQL queries can be more readable and easier to maintain than complex Pandas operations."})]}),(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:(0,r.jsx)("span",{class:"custom-header",children:"Unified Data Manipulation Language"})}),(0,r.jsx)("td",{children:"Users can manipulate data in Pandas similar to how they would in a relational database."})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"advantages-and-disadvantages",children:"Advantages and Disadvantages"}),"\n",(0,r.jsx)(n.h4,{id:"advantages",children:(0,r.jsx)(n.strong,{children:"Advantages"})}),"\n",(0,r.jsxs)("table",{class:"table-size-for-cloud-services",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{children:"Factors"}),(0,r.jsx)("th",{children:"Reason"})]})}),(0,r.jsxs)("tbody",{children:[(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:(0,r.jsx)("span",{class:"custom-header",children:"Efficiency"})}),(0,r.jsx)("td",{children:"Enables quicker modifications and querying of DataFrames using SQL, which is especially beneficial for users familiar with SQL."})]}),(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:(0,r.jsx)("span",{class:"custom-header",children:"Understanding"})}),(0,r.jsx)("td",{children:"SQL as a declarative language can make complex data manipulations easier to understand and implement."})]}),(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:(0,r.jsx)("span",{class:"custom-header",children:"Scalability"})}),(0,r.jsx)("td",{children:"Useful in scenarios where SQL-like processing is required before additional Pythonic analysis."})]})]})]}),"\n",(0,r.jsx)(n.h4,{id:"disadvantages",children:(0,r.jsx)(n.strong,{children:"Disadvantages"})}),"\n",(0,r.jsxs)("table",{class:"table-size-for-cloud-services",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{children:"Factors"}),(0,r.jsx)("th",{children:"Reason"})]})}),(0,r.jsxs)("tbody",{children:[(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:(0,r.jsx)("span",{class:"custom-header",children:"Complexity"})}),(0,r.jsxs)("td",{children:["Introduces a layer of complexity as it requires learning or integrating additional tools like ",(0,r.jsx)("code",{children:"pandasql"})," or ",(0,r.jsx)("code",{children:"SQLAlchemy"}),"."]})]}),(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:(0,r.jsx)("span",{class:"custom-header",children:"Resource Usage"})}),(0,r.jsx)("td",{children:"Might lead to higher memory usage if not handled properly, especially with large data sets."})]}),(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:(0,r.jsx)("span",{class:"custom-header",children:"Limitations"})}),(0,r.jsx)("td",{children:"While SQL-like, it may not support all features of SQL or may handle operations differently, leading to unexpected results."})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"example",children:"Example"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:"# you will have the employee_data dataframe in local memory\r\n# Refer the previous example for the dataframe\r\n\r\nfrom langchain import PromptTemplate\r\nfrom langchain.chains import LLMChain\r\n\r\nAVAILABILITY_SQL_QUERY_GENERATOR_PROMPT = \"\"\"\r\nSystem:\r\nYou act as an expert in writing SQL queries based on the context. Try to provide simple SQL queries\r\n\r\nRules for generating Queries:\r\n- Write SQL queries based on the context.\r\n- Extract the same column names as described in the headers.\r\n- The header (column name) must always be enclosed in double quotes in the query.\r\n- The SQL query should be in a standard format that supports the PANDASQL library in Python.\r\n- Always use 'LIKE' SQL query with '%' for the employee_name column search.\r\n- For months, use the format (%b-%Y) (e.g., Jan-2024).\r\n- The month columns will have availability percentages ranging from 0% to 100%.\r\n- The SQL query should always contain employee_name, employee_id, email, engineer_role, mission_assigned, technology columns for any type of context .\r\n- If the context is about availability, include the respective months in the SQL query.\r\n- Use the short forms for technology column search. Short forms are labview - LV, angular - Angular, fpga - FPGA, teststand - TS, c# - C#, python - Python, machine learning - ML, database - DB, marketing - Marketing, sales - Sales, web technology - WT, testing or test - Test, ui/ux - UI/UX, react - React, gc - GC, catalyst - Catalyst, leave - Leave, general - General, kss - KSS.\r\n- Use 'StartsWith' SQL query for the engineer_role column search if any engineer role is mentioned in the context from this list {engineer_role}.\r\n- Do not use technologies for the engineer_role column search.\r\n- If the context is about availability and the question has either <after> or <from> particular month then provide 6 consecutive months' availability.\r\n- These are the quarters\r\n    - Apr, May, Jun - First Quarter\r\n    - Jul, Aug, Sep - Second Quarter\r\n    - Oct, Nov, Dec - Third Quarter\r\n    - Jan, Feb, Mar - Fourth Quarter\r\n\r\nYou have a dataframe in Python with the name \"employees_availability_data\". The dataframe contains information about Employee details.\r\n\r\nThe data frame has the following headers:\r\nemployee_name - Name of the employee\r\nemployee_id - ID of the employee\r\nemail - Email address of the employee\r\nengineer_role - Project role or designation of the employee.\r\nmission_assigned - Mission in which the employee is assigned to\r\ntechnology - The Technolog(s) which is(are) known in the project\r\nJan-yyyy - The availability of the employee for January month. 'yyyy' represents year.\r\nFeb-yyyy - The availability of the employee for February month. 'yyyy' represents year.\r\nMar-yyyy - The availability of the employee for March month. 'yyyy' represents year.\r\nApr-yyyy - The availability of the employee for April month. 'yyyy' represents year.\r\nMay-yyyy - The availability of the employee for May month. 'yyyy' represents year.\r\nJun-yyyy - The availability of the employee for June month. 'yyyy' represents year.\r\nJul-yyyy - The availability of the employee for July month. 'yyyy' represents year.\r\nAug-yyyy - The availability of the employee for August month. 'yyyy' represents year.\r\nSep-yyyy - The availability of the employee for September month. 'yyyy' represents year.\r\nOct-yyyy - The availability of the employee for October month. 'yyyy' represents year.\r\nNov-yyyy - The availability of the employee for November month. 'yyyy' represents year.\r\nDec-yyyy - The availability of the employee for December month. 'yyyy' represents year.\r\n\r\nThe 12 columns next to technology column are months. The consecutive month column to the technology column will be the first month and Use present year for 'yyyy'.\r\n\r\nPresent_month_year:\r\n<present_month_year>{present_month_year}</present_month_year>\r\n\r\nContext (enclosed in a XML tag below) :\r\n<context>user: {context}</context>\r\n\r\nSQL Query Template:\r\nSELECT \"employee_name\", \"employee_id\", \"email\", \"engineer_role\", \"mission_assigned\", \"technology\" \"<respective months>\"\r\nFROM employee_availability_data\r\n\"\"\"\r\n\r\navailability_sql_query_generator_prompt_template = PromptTemplate(\r\n    input_variables=[\"context\",\"engineer_role\",\"present_month_year\"],\r\n    template=AVAILABILITY_SQL_QUERY_GENERATOR_PROMPT,\r\n    validate_template=False,\r\n)\r\n\r\n\r\navailability_sql_query_generator = LLMChain(\r\n    llm=ChatLLM,\r\n    prompt=availability_sql_query_generator_prompt_template\r\n    )\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:'query = "What is the employee id of Sanjay?";\r\n\r\nsql_query = availability_sql_query_generator.run({\r\n  context: query,\r\n  engineer_role: engineerroles.values(),\r\n  present_month_year: date.strftime("%b-%Y"),\r\n});\r\nprint(sql_query);\n'})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:"from pandasql import sqldf\r\noutput = sqldf(sql_query)\r\noutput\n"})}),"\n",(0,r.jsx)(n.h4,{id:"output",children:(0,r.jsx)(n.strong,{children:"Output"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:"OUTPUT: Query: 'SELECT \"employee_id\" FROM employees_availability_data WHERE \"employee_name\" LIKE \\'%Sanjay%\\'';\r\nOutput: 1655;\n"})}),"\n",(0,r.jsx)(n.p,{children:"By understanding and effectively deploying Pandas SQL in scenarios involving\r\ncomplex data operations, organizations can leverage both Python\u2019s powerful data\r\nmanipulation features alongside the intuitive and widely used SQL syntax, making\r\ntheir data retrieval and analysis processes more robust and efficient."})]})}function c(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}},28453:(e,n,a)=>{a.d(n,{R:()=>i,x:()=>l});var r=a(96540);const t={},s=r.createContext(t);function i(e){const n=r.useContext(s);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:i(e.components),r.createElement(s.Provider,{value:n},e.children)}}}]);