"use strict";(self.webpackChunksudeeparyan_knowledgebase=self.webpackChunksudeeparyan_knowledgebase||[]).push([[7140],{48973:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>a,contentTitle:()=>d,default:()=>h,frontMatter:()=>i,metadata:()=>l,toc:()=>o});var r=t(74848),s=t(28453);const i={},d=void 0,l={id:"RAG360/Data Ingestion/Vector Database/Self Hosted/Qdrant",title:"Qdrant",description:"Qdrant vector store",source:"@site/docs/RAG360/Data Ingestion/Vector Database/Self Hosted/Qdrant.md",sourceDirName:"RAG360/Data Ingestion/Vector Database/Self Hosted",slug:"/RAG360/Data Ingestion/Vector Database/Self Hosted/Qdrant",permalink:"/docs/RAG360/Data Ingestion/Vector Database/Self Hosted/Qdrant",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"ragSidebar",previous:{title:"Self Hosted",permalink:"/docs/category/self-hosted"},next:{title:"Weaviate",permalink:"/docs/RAG360/Data Ingestion/Vector Database/Self Hosted/Weaviate"}},a={},o=[{value:"Qdrant vector store",id:"qdrant-vector-store",level:2},{value:"Test results",id:"test-results",level:2},{value:"Embedding Method Configuration",id:"embedding-method-configuration",level:3},{value:"Embedding Method Performance",id:"embedding-method-performance",level:3},{value:"Advantages",id:"advantages",level:3},{value:"Disadvantages",id:"disadvantages",level:3}];function c(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",ol:"ol",p:"p",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h2,{id:"qdrant-vector-store",children:"Qdrant vector store"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Qdrant is an open-source vector similarity search engine and vector database\r\ndesigned to store, index, and query high-dimensional vectors efficiently."}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Currently Qdrant Vector store is supports multiple vector types like"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Dense vectors"}),"\n",(0,r.jsx)(n.li,{children:"Sparse vectors"}),"\n",(0,r.jsx)(n.li,{children:"Dense-uint8"}),"\n",(0,r.jsx)(n.li,{children:"Matryoshka vectors"}),"\n",(0,r.jsx)(n.li,{children:"Multi-vector representation using late interaction models"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Dense vectors can be created by models like Sentence transformers/Embedding\r\nmodels like OpenAI Ada - 002. Dense vectors are arrays that store each\r\nelement in a contiguous block of memory. A dense vector typically contains a\r\nvalue for every dimension, and most of these values are non-zero."}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Sparse vectors is created by fastembed python library. Sparse vectors store\r\nonly non-zero values and their corresponding indices. Most of the elements\r\nare assumed to be zero and only the non-zero values are explicitly\r\nrepresented."}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Supported models by fastembed to create sparse vectors"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Qdrant/BM25"}),"\n",(0,r.jsx)(n.li,{children:"Qdrant/bm42-all-minilm-l6-v2-attentions"}),"\n",(0,r.jsx)(n.li,{children:"prithivida/Splade_PP_en_v1"}),"\n",(0,r.jsxs)(n.li,{children:["For detailed information :\r\n",(0,r.jsx)(n.a,{href:"https://qdrant.github.io/fastembed/examples/Supported_Models/#supported-sparse-text-embedding-models",children:"Fastembed supported models"})]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"By default in llama-index-vector-stores-qdrant, it uses\r\nprithivida/Splade_PP_en_v1 to create sparse vectors."}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"While creating embeddings for Qdrant, by default the dense vectors alone will\r\nbe generated. Time taken to create these embeddings is also less when\r\ncompared to Weaviate. It supports only sematic search."}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["To create sparse vectors, while initializing the vector store, we need pass\r\nan argument named enable_hybrid to True. ",(0,r.jsx)(n.img,{alt:"image.png",src:t(80252).A+"",width:"874",height:"422"})]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Creating this sparse vectors, is taking more time than expected. It's around\r\n3 to 4 times slower than time required by Weaviate when using Splade models,\r\nit can reduced when moving to the Qdrant/BM25 model."}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Once this sparse vector is created, we can decide whether we need similarity\r\nbased results (dense vectors) or keyword based results (sparse vectors)\r\nbased on the alpha value."}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"When querying with hybrid mode, we can set similarity_top_k and sparse_top_k\r\nseparately."}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"sparse_top_k represents how many nodes will be retrieved from each dense and\r\nsparse query. For example, if sparse_top_k=5 is set, that means I will\r\nretrieve 5 nodes using sparse vectors and 5 nodes using dense vectors.\r\nsimilarity_top_k controls the final number of returned nodes. In the above\r\nsetting, we end up with 10 nodes. A fusion algorithm is applied to rank and\r\norder the nodes from different vector spaces (relative score fusion by\r\ndefault with llama-index). similarity_top_k=2 means the top two nodes after\r\nfusion are returned."}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Once the vectors are generated, we also need to specify the batch_size, the\r\nnumber vectors that will be uploaded at a time, by default it is 64."}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Parallel - Number of parallel processes of upload. By default it is 1. We\r\ncan specify based on the number of cores available in the system.\r\n",(0,r.jsx)(n.img,{alt:"image.png",src:t(4183).A+"",width:"582",height:"219"})]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Recommended configurations for 192.168.0.101 (Test PC) for generating sparse\r\nvectors"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"batch_size = <=10"})}),"\n",(0,r.jsx)(n.li,{children:"parallel - 2"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Qdrant provides UI support to see the available collections and visulaize\r\nthe dense vectors in it. To access the dashboard,\r\n",(0,r.jsx)(n.code,{children:"{qdrant_app_service_url}"}),"/dashboard and inside that enter the secret api\r\nkey to access the collections."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"The backup in the Qdrant vector store is called snapshot. We can configure\r\nin the Azure service, to take snapshots of collections on the regular\r\nintervals or download it manually."}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["The configuration for Qdrant can be still optimized by\r\n",(0,r.jsx)(n.a,{href:"https://qdrant.tech/documentation/guides/configuration/",children:"config.yaml"})," file."]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"test-results",children:"Test results"}),"\n",(0,r.jsxs)(n.p,{children:["The below test results are done with Qdrant ",(0,r.jsx)(n.code,{children:"version <1.9"})," and\r\nprithivida/Splade_PP_en_v1 for Sparse vectors"]}),"\n",(0,r.jsx)(n.h3,{id:"embedding-method-configuration",children:"Embedding Method Configuration"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Embedding Method"}),(0,r.jsx)(n.th,{children:"Batch Size"}),(0,r.jsx)(n.th,{children:"Vector Store"}),(0,r.jsx)(n.th,{children:"Hybrid Search Enabled"}),(0,r.jsx)(n.th,{children:"Time Consumption for Embedding"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Injestion pipeline running locally with PyPDF Reader"}),(0,r.jsx)(n.td,{children:"20"}),(0,r.jsx)(n.td,{children:"Qdrant"}),(0,r.jsx)(n.td,{children:"False"}),(0,r.jsx)(n.td,{children:"Around 30 s"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Injestion pipeline running locally with PyPDF Reader"}),(0,r.jsx)(n.td,{children:"20"}),(0,r.jsx)(n.td,{children:"Qdrant"}),(0,r.jsx)(n.td,{children:"True"}),(0,r.jsx)(n.td,{children:"Around 7 minutes 30 s"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Injestion pipeline running locally with PyPDF Reader"}),(0,r.jsx)(n.td,{children:"20"}),(0,r.jsx)(n.td,{children:"Weaviate"}),(0,r.jsx)(n.td,{children:"True"}),(0,r.jsx)(n.td,{children:"Around 45 s"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Injestion pipeline running locally with PyPDF Reader"}),(0,r.jsx)(n.td,{children:"20"}),(0,r.jsx)(n.td,{children:"Weaviate"}),(0,r.jsx)(n.td,{children:"False"}),(0,r.jsx)(n.td,{children:"Around 45 s"})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"embedding-method-performance",children:"Embedding Method Performance"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Embedding Method"}),(0,r.jsx)(n.th,{children:"Vector Store"}),(0,r.jsx)(n.th,{children:"Hybrid Search Enabled"}),(0,r.jsx)(n.th,{children:"Expected Answer Relevance Score"}),(0,r.jsx)(n.th,{children:"Context Relevance Score"}),(0,r.jsx)(n.th,{children:"Answer Relevance Score"}),(0,r.jsx)(n.th,{children:'No of Questions with "I couldn\'t find answer"'})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Injestion pipeline running locally with PyPDF Reader"}),(0,r.jsx)(n.td,{children:"Qdrant"}),(0,r.jsx)(n.td,{children:"False"}),(0,r.jsx)(n.td,{children:"0.59"}),(0,r.jsx)(n.td,{children:"0.82"}),(0,r.jsx)(n.td,{children:"0.85"}),(0,r.jsx)(n.td,{children:"7"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Injestion pipeline running locally with PyPDF Reader"}),(0,r.jsx)(n.td,{children:"Qdrant"}),(0,r.jsx)(n.td,{children:"True"}),(0,r.jsx)(n.td,{children:"0.61"}),(0,r.jsx)(n.td,{children:"0.88"}),(0,r.jsx)(n.td,{children:"0.88"}),(0,r.jsx)(n.td,{children:"5"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Injestion pipeline running locally with PyPDF Reader"}),(0,r.jsx)(n.td,{children:"Weaviate"}),(0,r.jsx)(n.td,{children:"True"}),(0,r.jsx)(n.td,{children:"0.59"}),(0,r.jsx)(n.td,{children:"0.86"}),(0,r.jsx)(n.td,{children:"0.82"}),(0,r.jsx)(n.td,{children:"8"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Injestion pipeline running locally with PyPDF Reader"}),(0,r.jsx)(n.td,{children:"Weaviate"}),(0,r.jsx)(n.td,{children:"False"}),(0,r.jsx)(n.td,{children:"NA"}),(0,r.jsx)(n.td,{children:"NA"}),(0,r.jsx)(n.td,{children:"NA"}),(0,r.jsx)(n.td,{children:"NA"})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"advantages",children:"Advantages"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"SPLADE is supported in Qdrant."}),"\n",(0,r.jsx)(n.li,{children:"Collections are not lost if we use App Service, but can create snapshots of\r\ncollections."}),"\n",(0,r.jsx)(n.li,{children:"Qdrant supports multiple vector types"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"disadvantages",children:"Disadvantages"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Time taken to create embeddings and retrieve embeddings is quite high when\r\nusing Splade models for Sparse vectors. It can be rectified by BM25 models"}),"\n",(0,r.jsx)(n.li,{children:"With Qdrant collections are mapped with Azure File Share and App Service\r\nrestarts for maintenance - App Service takes a longer time to restore the\r\ncollections from File Share to App Service container.The time to restore\r\ndepends on the size of the collections.This restore time has a conflict with\r\nthe Azure App Service start-up time value(Max-startup time for Azure App\r\nservice - 30 minutes)."}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},80252:(e,n,t)=>{t.d(n,{A:()=>r});const r=t.p+"assets/images/qudrant1-9852640508893fffb9e0abd2995167b2.png"},4183:(e,n,t)=>{t.d(n,{A:()=>r});const r=t.p+"assets/images/qudrant2-695b32226391919cdc48a8c1c3ac029b.png"},28453:(e,n,t)=>{t.d(n,{R:()=>d,x:()=>l});var r=t(96540);const s={},i=r.createContext(s);function d(e){const n=r.useContext(i);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:d(e.components),r.createElement(i.Provider,{value:n},e.children)}}}]);