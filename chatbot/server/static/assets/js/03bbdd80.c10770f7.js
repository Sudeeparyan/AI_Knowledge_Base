"use strict";(self.webpackChunksudeeparyan_knowledgebase=self.webpackChunksudeeparyan_knowledgebase||[]).push([[6560],{56828:(e,r,i)=>{i.r(r),i.d(r,{assets:()=>t,contentTitle:()=>l,default:()=>a,frontMatter:()=>d,metadata:()=>c,toc:()=>o});var n=i(74848),s=i(28453);const d={},l=void 0,c={id:"RAG360/Retrieval/Unstructured/Reranking/Logical Reranking/Relative Score Fusion",title:"Relative Score Fusion",description:"Relative score fusion algorithm",source:"@site/docs/RAG360/Retrieval/Unstructured/Reranking/Logical Reranking/Relative Score Fusion.md",sourceDirName:"RAG360/Retrieval/Unstructured/Reranking/Logical Reranking",slug:"/RAG360/Retrieval/Unstructured/Reranking/Logical Reranking/Relative Score Fusion",permalink:"/docs/RAG360/Retrieval/Unstructured/Reranking/Logical Reranking/Relative Score Fusion",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"ragSidebar",previous:{title:"Overview",permalink:"/docs/RAG360/Retrieval/Unstructured/Reranking/Logical Reranking/Overview"},next:{title:"Reciprocal Reranking",permalink:"/docs/RAG360/Retrieval/Unstructured/Reranking/Logical Reranking/Reciprocal Reranking"}},t={},o=[{value:"Relative score fusion algorithm",id:"relative-score-fusion-algorithm",level:3},{value:"Normalized score calculation formula:",id:"normalized-score-calculation-formula",level:3},{value:"Keyword Search Scores Normalization",id:"keyword-search-scores-normalization",level:3},{value:"Vector Search Scores Normalization",id:"vector-search-scores-normalization",level:3},{value:"Final Normalized Scores without alpha",id:"final-normalized-scores-without-alpha",level:3},{value:"Detailed Calculations",id:"detailed-calculations",level:3},{value:"Relative score fusion final result",id:"relative-score-fusion-final-result",level:3}];function h(e){const r={code:"code",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,s.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.h3,{id:"relative-score-fusion-algorithm",children:"Relative score fusion algorithm"}),"\n",(0,n.jsxs)(r.ol,{children:["\n",(0,n.jsxs)(r.li,{children:["\n",(0,n.jsx)(r.p,{children:"Relative score fusion is supported in both Weaviate and Qdrant."}),"\n"]}),"\n",(0,n.jsxs)(r.li,{children:["\n",(0,n.jsx)(r.p,{children:"In contrast to rankedFusion, however, relativeScoreFusion derives each\nobjects score by normalizing the metrics output by the vector search and\nkeyword search respectively. The highest value becomes 1, the lowest value\nbecomes 0, and others end up in between according to this scale. The total\nscore is thus calculated by a scaled sum of normalized vector similarity and\nnormalized BM25/sparse vector score."}),"\n"]}),"\n",(0,n.jsxs)(r.li,{children:["\n",(0,n.jsx)(r.p,{children:"Consider, the retriever returns five objects with document id (from 0 to 4),\nand scores from keyword and vector search, ordered by score."}),"\n",(0,n.jsxs)(r.table,{children:[(0,n.jsx)(r.thead,{children:(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.th,{children:"Search Type"}),(0,n.jsx)(r.th,{children:"(id): score"}),(0,n.jsx)(r.th,{children:"(id): score"}),(0,n.jsx)(r.th,{children:"(id): score"}),(0,n.jsx)(r.th,{children:"(id): score"}),(0,n.jsx)(r.th,{children:"(id): score"})]})}),(0,n.jsxs)(r.tbody,{children:[(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"Keyword"}),(0,n.jsx)(r.td,{children:"(1): 5"}),(0,n.jsx)(r.td,{children:"(0): 2.6"}),(0,n.jsx)(r.td,{children:"(2): 2.3"}),(0,n.jsx)(r.td,{children:"(4): 0.2"}),(0,n.jsx)(r.td,{children:"(3): 0.09"})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"Vector"}),(0,n.jsx)(r.td,{children:"(2): 0.6"}),(0,n.jsx)(r.td,{children:"(4): 0.598"}),(0,n.jsx)(r.td,{children:"(0): 0.596"}),(0,n.jsx)(r.td,{children:"(1): 0.594"}),(0,n.jsx)(r.td,{children:"(3): 0.009"})]})]})]}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(r.h3,{id:"normalized-score-calculation-formula",children:"Normalized score calculation formula:"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-js",children:" Normalized Score = (Original Score - Minimum Score) / (Maximum Score - Minimum Score)\n"})}),"\n",(0,n.jsx)(r.h3,{id:"keyword-search-scores-normalization",children:"Keyword Search Scores Normalization"}),"\n",(0,n.jsxs)(r.ol,{children:["\n",(0,n.jsx)(r.li,{children:"Maximum score - 5"}),"\n",(0,n.jsx)(r.li,{children:"Minimum score - 0.09"}),"\n"]}),"\n",(0,n.jsxs)(r.table,{children:[(0,n.jsx)(r.thead,{children:(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.th,{children:"Document ID"}),(0,n.jsx)(r.th,{children:"Original Score"}),(0,n.jsx)(r.th,{children:"Calculation for Normalization"}),(0,n.jsx)(r.th,{children:"Normalized Score"})]})}),(0,n.jsxs)(r.tbody,{children:[(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"1"}),(0,n.jsx)(r.td,{children:"5"}),(0,n.jsx)(r.td,{children:"(5 - 0.09) / (5 - 0.09)"}),(0,n.jsx)(r.td,{children:"1.0"})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"0"}),(0,n.jsx)(r.td,{children:"2.6"}),(0,n.jsx)(r.td,{children:"(2.6 - 0.09) / (5 - 0.09)"}),(0,n.jsx)(r.td,{children:"0.511"})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"2"}),(0,n.jsx)(r.td,{children:"2.3"}),(0,n.jsx)(r.td,{children:"(2.3 - 0.09) / (5 - 0.09)"}),(0,n.jsx)(r.td,{children:"0.450"})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"4"}),(0,n.jsx)(r.td,{children:"0.2"}),(0,n.jsx)(r.td,{children:"(0.2 - 0.09) / (5 - 0.09)"}),(0,n.jsx)(r.td,{children:"0.022"})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"3"}),(0,n.jsx)(r.td,{children:"0.09"}),(0,n.jsx)(r.td,{children:"(0.09 - 0.09) / (5 - 0.09)"}),(0,n.jsx)(r.td,{children:"0.0"})]})]})]}),"\n",(0,n.jsx)(r.h3,{id:"vector-search-scores-normalization",children:"Vector Search Scores Normalization"}),"\n",(0,n.jsxs)(r.ol,{children:["\n",(0,n.jsx)(r.li,{children:"Maximum score - 5"}),"\n",(0,n.jsx)(r.li,{children:"Minimum score - 0.09"}),"\n"]}),"\n",(0,n.jsxs)(r.table,{children:[(0,n.jsx)(r.thead,{children:(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.th,{children:"Document ID"}),(0,n.jsx)(r.th,{children:"Original Score"}),(0,n.jsx)(r.th,{children:"Calculation for Normalization"}),(0,n.jsx)(r.th,{children:"Normalized Score"})]})}),(0,n.jsxs)(r.tbody,{children:[(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"2"}),(0,n.jsx)(r.td,{children:"0.6"}),(0,n.jsx)(r.td,{children:"(0.6 - 0.009) / (0.6 - 0.009)"}),(0,n.jsx)(r.td,{children:"1.0"})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"4"}),(0,n.jsx)(r.td,{children:"0.598"}),(0,n.jsx)(r.td,{children:"(0.598 - 0.009) / (0.6 - 0.009)"}),(0,n.jsx)(r.td,{children:"0.996"})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"0"}),(0,n.jsx)(r.td,{children:"0.596"}),(0,n.jsx)(r.td,{children:"(0.596 - 0.009) / (0.6 - 0.009)"}),(0,n.jsx)(r.td,{children:"0.993"})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"1"}),(0,n.jsx)(r.td,{children:"0.594"}),(0,n.jsx)(r.td,{children:"(0.594 - 0.009) / (0.6 - 0.009)"}),(0,n.jsx)(r.td,{children:"0.986"})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"3"}),(0,n.jsx)(r.td,{children:"0.009"}),(0,n.jsx)(r.td,{children:"(0.009 - 0.009) / (0.6 - 0.009)"}),(0,n.jsx)(r.td,{children:"0.0"})]})]})]}),"\n",(0,n.jsx)(r.h3,{id:"final-normalized-scores-without-alpha",children:"Final Normalized Scores without alpha"}),"\n",(0,n.jsxs)(r.table,{children:[(0,n.jsx)(r.thead,{children:(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.th,{children:"Search Type"}),(0,n.jsx)(r.th,{children:"(id): score"}),(0,n.jsx)(r.th,{children:"(id): score"}),(0,n.jsx)(r.th,{children:"(id): score"}),(0,n.jsx)(r.th,{children:"(id): score"}),(0,n.jsx)(r.th,{children:"(id): score"})]})}),(0,n.jsxs)(r.tbody,{children:[(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"Keyword"}),(0,n.jsx)(r.td,{children:"(1): 1.0"}),(0,n.jsx)(r.td,{children:"(0): 0.511"}),(0,n.jsx)(r.td,{children:"(2): 0.450"}),(0,n.jsx)(r.td,{children:"(4): 0.022"}),(0,n.jsx)(r.td,{children:"(3): 0.0"})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"Vector"}),(0,n.jsx)(r.td,{children:"(2): 1.0"}),(0,n.jsx)(r.td,{children:"(4): 0.996"}),(0,n.jsx)(r.td,{children:"(0): 0.993"}),(0,n.jsx)(r.td,{children:"(1): 0.986"}),(0,n.jsx)(r.td,{children:"(3): 0.0"})]})]})]}),"\n",(0,n.jsx)(r.h3,{id:"detailed-calculations",children:"Detailed Calculations"}),"\n",(0,n.jsx)(r.p,{children:"For Combined Relative score fusion Results with \u03b1 = 0.6 | Document ID | Keyword\nScore | Vector Score | Combined Score Calculation | Combined Score |\n|-------------|---------------|--------------|----------------------------------------------------------|----------------|\n| 1 | 1.0 | 0.986 | 0.6 \xd7 1.0 + 0.4 \xd7 0.986 = 0.6 + 0.3944 = 0.9944 | 0.9944 | |\n0 | 0.511 | 0.993 | 0.6 \xd7 0.511 + 0.4 \xd7 0.993 = 0.3066 + 0.3972 = 0.7038 |\n0.7038 | | 2 | 0.450 | 1.0 | 0.6 \xd7 0.450 + 0.4 \xd7 1.0 = 0.27 + 0.4 = 0.67 | 0.67\n| | 4 | 0.022 | 0.996 | 0.6 \xd7 0.022 + 0.4 \xd7 0.996 = 0.0132 + 0.3984 = 0.4116 |\n0.4116 | | 3 | 0.0 | 0.0 | 0.6 \xd7 0.0 + 0.4 \xd7 0.0 = 0.0 | 0.0 |"}),"\n",(0,n.jsx)(r.h3,{id:"relative-score-fusion-final-result",children:"Relative score fusion final result"}),"\n",(0,n.jsxs)(r.table,{children:[(0,n.jsx)(r.thead,{children:(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.th,{children:"Algorithm Type"}),(0,n.jsx)(r.th,{children:"(id): score"}),(0,n.jsx)(r.th,{children:"(id): score"}),(0,n.jsx)(r.th,{children:"(id): score"}),(0,n.jsx)(r.th,{children:"(id): score"}),(0,n.jsx)(r.th,{children:"(id): score"})]})}),(0,n.jsx)(r.tbody,{children:(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"Relative"}),(0,n.jsx)(r.td,{children:"(1): 0.993"}),(0,n.jsx)(r.td,{children:"(0): 0.752"}),(0,n.jsx)(r.td,{children:"(2): 0.725"}),(0,n.jsx)(r.td,{children:"(4): 0.509"}),(0,n.jsx)(r.td,{children:"(3): 0.0"})]})})]})]})}function a(e={}){const{wrapper:r}={...(0,s.R)(),...e.components};return r?(0,n.jsx)(r,{...e,children:(0,n.jsx)(h,{...e})}):h(e)}},28453:(e,r,i)=>{i.d(r,{R:()=>l,x:()=>c});var n=i(96540);const s={},d=n.createContext(s);function l(e){const r=n.useContext(d);return n.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function c(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:l(e.components),n.createElement(d.Provider,{value:r},e.children)}}}]);